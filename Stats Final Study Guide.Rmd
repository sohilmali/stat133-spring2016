---
title: "Stats Final Study Guide"
author: "Sohil Mali"
date: "4/22/16"
output: 
  html_document:
    fig_height: 3
    fig_width: 5
---
<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments("/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Stats Final Study Guide.Rmd")
```
<!-- Don't edit the material above this line -->


### Regular Expressions

A regular expression (regex) is a pattern that describes a set of strings.

ex: The regex “[a-cx-z]”" matches “a”,“b”,“c”,“x”,“y”,“z”

ex: The regex “ba+d”" matches “bad”, “baad”, “baaad” etc but not “bd”

Regular expressions are used for several purposes:

to detect whether a pattern is contained in a string. Use *filter()* and *grepl()*

to replace the elements of that pattern with something else. Use *mutate()* and *gsub()*

to extract a component that matches the patterns. Use *extractMatches()* from the DataComputing package.



### Reading Regular Expressions

There are simple regular expressions and complicated ones. All of them look foreign until you learn how to read them.

There are many regular expression tutorials on the Internet, for instance this interactive one. Here is a useful cheat sheet

Some basics:

* Very simple patterns:

A single `.` means “any character.”

A character, e.g., `b`, means just that character.

Characters enclosed in square brackets, e.g., `[aeiou]` means any of those characters. (So, `[aeiou]` is a pattern describing a vowel.)

The `^` inside square brackets means “any except these.” So, a consonant is `[^aeiou]`

* Alternatives. A vertical bar means “either.” For example `(S|s)ohil` matches Sohil and sohil

* Repeats

Two simple patterns in a row, means those patterns consecutively. Example: `M[aeiou]` means a capital M followed by a lower-case vowel.

A simple pattern followed by a `+` means “one or more times.” For example `M(ab)+` means M followed by one or more ab.

A simple pattern followed by a `?` means “zero or one time.”

A simple pattern followed by a `*` means “zero or more times.”

A simple pattern followed by `{2}` means “exactly two times.” Similarly, `{2,5}` means between two and five times, `{6,}` means six times or more.

* Start and end of strings. For instance, `[aeiou]{2}` means “exactly two vowels in a row.”

`^` at the beginning of a regular expression means “the start of the string”

`$` at the end means “the end of the string.”


![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/download.png)

![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/download (1).png)



### `grepl()`, `gsub()`, `extractMatches()`

Regular expressions are used for several purposes:

* to detect whether a pattern is contained in a string. Use filter() and grepl()
details:

1. grepl() searches for matches to regexp within each element of a character vector and returns a logical vector

2. syntax: grepl(regex,vec)


* to replace the elements of that pattern with something else. Use mutate() and gsub()
details:

1. gsub() searches for matches to argument regexp within each element of a character vector and performs replacement of all matches

2. syntax:gsub(regex, replacement, vec)


* to pull out the matches for marked regions of regular expressions use extractMatches() from the DataComputing package.

Details:

1. input is a data table and output is a data table with one or more additional columns with the extractions

2. syntax is df %>% extractMatches(regex, var,...)

3. wrap part of the regexp in parentheses to signal that the matching content is to be extracted as a string

4. when there is no match extractMatches() returns NA example


### Unix Commands

* Create a new directory

mkdir practice

* Change to the created directory:

cd practice

* Let’s download the dataset starwars.csv from the github repo. Use curl followed by the URL of the data file and indicate an output file (e.g. stars.csv):

curl "https://raw.githubusercontent.com/gastonstat/stat133/master/datasets/starwars.csv" -o stars.csv

* Now check the contents of practice

ls practice


### Basic inspection

Let’s start inspecting the file stars.csv.

* cat allows you to display the contents of the file on the terminal:

cat stars.csv

*The commands head and tail let you look at the first and last observations:

 first 5 rows
head -5 stars.csv

 last 4 rows
tail -4 stars.csv

*wc (word count) gives you information about the number of characters, lines, and words

# default
wc stars.csv

 number of characters
wc -c stars.csv

 number of lines (i.e. rows)
wc -l stars.csv

 number of words (not very useful in this case)
wc -w stars.csv


### Using egrep

Search for different individuals:

 "female" subjects
egrep female stars.csv  #here female is a regular expression

 "jedi"
egrep [^_]jedi stars.csv  #here we need to avoid no_jedi.


![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Screen Shot 2016-04-25 at 12.05.31 AM.png)


![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Screen Shot 2016-04-25 at 12.01.29 AM.png)

![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Screen Shot 2016-04-25 at 12.03.24 AM.png)


### Creating an XML documents from within R

First we will see how to creat an XML document from within R. Later we will see how to read/process XML from within R.

It will be helpful to have in your mind the structure of the XML document (i.e the XML tree) before you do anything in R, especially when you’re creating a new XML document.

You will need the XML package and the functions newXMLDoc, newXMLNode, and saveXML.

The syntax for newXMLNode is:

`newXMLNode(name,attrs=NULL,doc=NULL, parent=NULL)`

where:

`name` is the name of the node
`attrs` is an attribute
`doc` is the name of the root node
`parent` is the name of the parent node

Here is an example

![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Screen Shot 2016-04-25 at 12.10.14 AM.png)



library(XML)

doc <- newXMLDoc()  
root <- newXMLNode("toplevel", doc = doc)   
child1 <- newXMLNode("level1", parent = root)   
newXMLNode("level2", "This is the content", parent = child1)
saveXML(doc, file = "/Users/Adam/Desktop/simple.xml")



### Making a KML file

Steps:

1. Diagram the tree structure of this document.

2. Load the XML package. library(XML)

3. Creat the document doc <- newXMLDoc()

4. Using newXMLNode, create the root node.

`root <- newXMLNode("kml",namespaceDefinitions = "http://www.opengis.net/kml/2.2", doc = doc)`


5. Use newXMLNode to create the Document node and its children.

docmt <- newXMLNode("Document", parent = root)
pm <- newXMLNode("Placemark", parent = docmt)
name <- newXMLNode("name", "New York City", parent = pm)
description <- newXMLNode("description", "New York City", parent = pm)
pt <- newXMLNode("Point", parent = pm)
newXMLNode("coordinates", "-74.006393,40.714172,0", parent = pt)


### XPath Language

Xpath is a language to navigate through elements and attributes in an XML/HTML document.

It uses path expressions to select nodes in an XML document and identifies patterns to match data or content.

XPath Syntax

The key concept is knowing how to write XPath expressions. XPath expressions have a syntax similar to the way files are located in a hierarchy of directories/folders in a computer file system. For instance:

`/movies/movie`

is the XPath expression to locate the first movie element that is the child of the movies elements.

The main path expressions (i.e. symbols) are:

![](/Users/sohil/Desktop/Sophomore spring semester/Stats 133/Screen Shot 2016-04-25 at 12.12.47 AM.png)

